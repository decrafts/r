---
layout: post
title: Система управления климатом в квартире
permalink: /climate-control-system-for-the-apartment.html
categories: [ktulhu]
---

В связи с потребностью в свежем воздухе было решено соорудить приточную вентиляцию. 
Но не простую, а с возможностью регулировки мощности в зависимости от уровня CO<sub>2</sub> в помещении 
с целью поддержания оптимального для дыхания состава воздуха. 
Так как в окружающем воздухе иногда возникают заметные концентрации запахов было решено добавить 
датчики недопускающие их проникновения в помещение. Из этой затеи получилась:

**Система управления климатом на контроллере ESP8266** 

Позволяет осуществлять контроль наружней и внутренней климатической обстановки, 
управление приточной вентиляцией и мониторинг параметров.

Погодная станция решает задачи:
Изменения температуры, влажности и давления вне помещения.
Измерения загазованности по показателям метана, сероводорода, аммиака.
Измерения уровня углекислого газа CO<sub>2</sub> в помещении.
Управление приточной вентиляцией в ручном и автоматическом режимах.

**Внешние датчики**

![наружняя сторона](/images/2017/11/external-out.jpg)
Снаружи расположен датчик температуры, влажности и давления BME280 подулюченный к шине i2c и питаню +3.3v, 
датчик температуры и влажности AM2315 также подключенный к i2c и 3.3v и сенсоры датчиков аммиака, сероводорода и метана.
Все это прикрыто утеплителем на клейкой основе для отсечения тепла из помещения.

![внутренняя сторона](/images/2017/11/external-in.jpg)
С внутретренней стороны расположен АЦП, преобразователь уровней 5v<>3.3v для согласования сигналов устройств с разными напряжениями питания, датчики MQ4 MQ136, MQ137, датчик BMP85. 
Коммутация выполнена гибкими проводами и сведена на клемник для подключения межблочного пятижильного кабеля. 
Кабель сечением 0.75mm2, назначение жил: напряжения 0V, 5V, 3.3V и сигналы i2c шины SCL, SDA.

![место установки](/images/2017/11/external-place.jpg)
Место установки - панель ограждения балкона, в которую врезана установочная электрическая коробка без дна. 

![колпак](/images/2017/11/external-cover.jpg)
Изнутри и снаружи модуль прикрыт съемными пластиковыми вентиляционными колпаками.

**Модуль питания и реле**

![модуль реле](/images/2017/11/relay-v1.jpg)

**Модуль контроллера**

![модуль контроллера](/images/2017/11/controller-v1.jpg)

Код [прошивки на github](https://github.com/codemaste/weather-station-esp8266)

**Сохранение и мониторинг погодных показателей online**

[сайт с данными мониторинга погоды](https://dobrolubov.com/)
Данные с XML интерфейса контроллера складываются в MySQL и могут отображаться на сайте в виде графиков за день/неделю/месяц.

[данные на сайте народного мониторинга](https://narodmon.ru/4231)

[выгрузка в сервис ThingSpeak](https://thingspeak.com/channels/322829)

[отображение на сервисе FreeBoard](https://freeboard.io/board/OgpGzU)

Интерфейс управления выглядит так:
![Интерфейс управления](/images/2017/11/control-interface.png)

**Система приточной вентиляции**

![фильтры](/images/2017/11/vent-out.jpg)
Забор и фильтрация наружнего воздуха.

![TD-160/100](/images/2017/11/vent-in.jpg)
Подача воздуха в помещение.
